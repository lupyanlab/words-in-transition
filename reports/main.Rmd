---
title: "The emergence of lexical categories from iterated vocal imitation"
author: "Pierce Edmiston, Marcus Perlman, and Gary Lupyan"
output:
  html_document:
    theme: flatly
---

This research intends to show that conventionalized word forms can arise gradually and uneffortfully simply through the repeated imitation of nonverbal, environmental sounds. Participants played an online version of the children's game "telephone" where an auditory message is passed from person to person with the goal of keeping the message unchanged. Instead of a typical message, participants had to pass on imitations of nonverbal environment sounds (e.g., glass breaking, water splashing). These imitations were hypothesized to become more wordlike as they are repeated.

```{r config, echo = FALSE, warning = FALSE, message = FALSE, results = "hide"}
library(knitr)
library(printr)
library(broom)
library(DiagrammeR)
library(grid)
library(gridExtra)
library(crotchet)
library(png)
library(dplyr)

opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  results = "hide",
  cache = TRUE,
  cache.path = ".cache/",
  fig.path = "figs/",
  fig.width = 10,
  fig.height = 3.5
)

read_chunk("theme.R")
wordsintransition::read_wordsintransition_chunks()

read_results_chunks <- function(experiments) {
  scripts <- paste(experiments, "results.R", sep = "/")
  sapply(scripts, read_chunk)
}

read_results_chunks(c(
  "2-collect-imitations",
  "3-imitation-matches",
  "4-collect-transcriptions",
  "5-transcription-matches",
  "6-learning-sound-names"
))
```

```{r theme}
```

<!-- WARNING: Can't hide graphviz output.
```{r definitions, engine = "dot", results = "hide", fig.show = "hide"}
```
-->

```{r 2-setup}
```

```{r 2-similarity-judgments-mod}
```

```{r 2-similarity-judgments-plot, fig.show = "hide"}
```

```{r 4-setup}
```

```{r 4-transcription-agreement-distance, fig.show = "hide"}
```

```{r telephone-game}
# Make a three-panel plot:
# (A) telephone game design
# (B) acoustic similarity
# (C) transcription distance
#
# The telephone game design is build from a graphviz
# dot source file. Ideally this graphviz file could
# be read in and converted to a grob. Alas it cannot
# be done.
#
# definitions_grob <- find_graphviz("definitions", package = "wordsintransition") %>%
#   Diagrammer::grViz() %>%
#   htmlwidget_to_grob()  # doesn't exist
#
# A workaround is to render the graphviz as a png file
# and then load it in as a grob.
definitions_grob <- "figs/definitions-1.png" %>% readPNG() %>% rasterGrob()

grid.arrange(
  definitions_grob,
  gg_similarity_judgments,
  gg_distance,
  nrow = 1, widths = c(0.2, 0.4, 0.4)
)
```

# Matching back to original

<!-- WARNING: Can't hide graphviz output.
```{r true-seed, engine = "dot", results = "hide", fig.show = "hide"}
```
-->

<!-- WARNING: Can't hide graphviz output.
```{r category-match, engine = "dot", results = "hide", fig.show = "hide"}
```
-->

<!-- WARNING: Can't hide graphviz output.
```{r specific-match, engine = "dot", results = "hide", fig.show = "hide"}
```
-->

```{r question-types, results = "hide", fig.show = "hide", fig.width = 4, fig.height = 4}
read_chunk_fig <- function(label, draw = TRUE, ...) {
  label %>%
    paste0("-1.png") %>%
    file.path("figs", .) %>%
    readPNG() %>%
    rasterGrob(...) %T>%
    { if(draw) grid.draw(.) }
}

grid.newpage()
read_chunk_fig("true-seed", y = 0.8, width = 0.9)
read_chunk_fig("category-match", y = 0.5, width = 0.9)
read_chunk_fig("specific-match", y = 0.2, width = 0.9)
```

```{r 3-setup}
```

```{r 3-data}
```

```{r 3-models}
```

```{r 3-match-to-seed, fig.show = "hide"}
```

```{r 5-setup}
```

```{r 5-match-transcriptions-mod}
```

```{r 5-match-transcriptions-plot, fig.show = "hide"}
```

```{r guess-the-seed}
question_types_grob <- read_chunk_fig("question-types", draw = FALSE)
grid.arrange(
  question_types_grob,
  gg_match_to_seed,
  gg_match_transcriptions,
  nrow = 1
)
```

```{r 6-setup}
```

```{r 6-errors, fig.show = "hide"}
```

```{r 6-rts-over-trials, fig.show = "hide"}
```

```{r 6-results, fig.show = "hide"}
```

# Category learning

```{r category-learning}
grid.arrange(
  (rt_plot %+% first_last_gen) + theme(legend.position = "none"),
  (error_plot %+% first_last_gen) + theme(legend.position = c(0.8, 0.9)),
  nrow = 1
)
```
